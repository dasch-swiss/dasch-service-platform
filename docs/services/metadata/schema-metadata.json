{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "https://dasch.swiss/schema/schema-metadata.json",
  "title": "Metadata Schema",
  "description": "Schema definition of DSP metadata",
  "type": "object",
  "properties": {
    "$schema": {
      "description": "Schema definition",
      "type": "string"
    },
    "project": {
      "$ref": "#/definitions/project"
    },
    "datasets": {
      "description": "The datasets of the project",
      "type": "array",
      "items": {
        "type": "object",
        "$ref": "#/definitions/dataset"
      }
    },
    "persons": {
      "description": "",
      "type": "array",
      "items": {
        "type": "object",
        "$ref": "#/definitions/person"
      }
    },
    "organizations": {
      "description": "Organizations relevant to the project.",
      "type": "array",
      "items": {
        "type": "object",
        "$ref": "#/definitions/organization"
      }
    },
    "grants": {
      "description": "Grants relevant to the project.",
      "type": "array",
      "items": {
        "type": "object",
        "$ref": "#/definitions/grant"
      }
    }
  },
  "required": [
    "$schema",
    "project",
    "datasets"
  ],
  "additionalProperties": false,
  "definitions": {
    "text": {
      "type": "object",
      "title": "Text Property (multilingual)",
      "patternProperties": {
        "^[a-z]{2}$": {
          "type": "string",
          "title": "Text in a particular language",
          "description": "Pairs of language short codes and text strings (e.g. `'en': 'some text'`)"
        }
      },
      "additionalProperties": false,
      "minProperties": 1
    },
    "date": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "format": "date",
      "description": "A date in the format `yyyy-mm-dd`"
    },
    "url": {
      "type": "string",
      "format": "uri",
      "description": "A URL"
    },
    "place": {
      "type": "string",
      "format": "uri",
      "description": "A place"
    },
    "project": {
      "description": "A project on the DSP",
      "type": "object",
      "properties": {
        "@id": {
          "type": "string",
          "description": "Identifier of the project"
        },
        "@type": {
          "type": "string",
          "description": "Type of this object",
          "const": "Project"
        },
        "name": {
          "type": "string",
          "description": "The name of the project"
        },
        "shortcode": {
          "type": "string",
          "description": "The four digit hexadecimal project shortcode, assigned to the project by the DaSCH.",
          "pattern": "^[0-9A-F]{4}$"
        },
        "description": {
          "description": "A human readable description of the project.",
          "$ref": "#/definitions/text"
        },
        "startDate": {
          "description": "Start date of the project.",
          "$ref": "#/definitions/date"
        },
        "keywords": {
          "type": "array",
          "description": "Keywords/Tags describing the project.",
          "items": {
            "$ref": "#/definitions/text"
          }
        },
        "disciplines": {
          "description": "Discipline/field of research of the project.",
          "type": "array",
          "minItems": 1,
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/text"
              },
              {
                "$ref": "#/definitions/url"
              }
            ]
          }
        },
        "temporalCoverage": {
          "description": "Temporal coverage of the project.",
          "type": "array",
          "minItems": 1,
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/text"
              },
              {
                "$ref": "#/definitions/url"
              }
            ]
          }
        },
        "spatialCoverage": {
          "description": "Spatial coverage of the project.",
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/definitions/place"
          }
        },
        "urls": {
          "description": "URLs of the project. The first one should be the project landing page or website. One additional website can be added, if relevant.",
          "type": "array",
          "minItems": 1,
          "maxItems": 2,
          "items": {
            "$ref": "#/definitions/url"
          }
        },
        "dataManagementPlan": {
          "type": "object",
          "description": "Data management plan of the project",
          "properties": {
            "available": {
              "type": "boolean"
            },
            "url": {
              "$ref": "#/definitions/url"
            },
            "additionalProperties": false
          }
        },
        "endDate": {
          "description": "End date of the project.",
          "$ref": "#/definitions/date"
        },
        "publications": {
          "description": "Publications produced during the lifetime of the project.",
          "type": "array",
          "items": {
            "description": "Citation form of a publication.",
            "type":"string"
          }
        },
        "grants": {
          "description": "Financial grants of the project.",
          "type":"array",
          "items": {
            "description": "Reference to a grant ID.",
            "type":"string"
          }
        },
        "alternateNames": {
          "description": "Alternative names of the project.",
          "type":"array",
          "items": {
            "$ref": "#/definitions/text"
          }
        }
      },
      "required": [
        "name",
        "shortcode",
        "description",
        "startDate",
        "keywords",
        "disciplines",
        "temporalCoverage",
        "spatialCoverage",
        "urls"
      ],
      "additionalProperties": false
    },
    "grant": {
      "type":"object",
      "description": "A financial grant.",
      "properties": {
        "@id": {
          "type": "string",
          "description": "Unique id of the grant."
        },
        "@type": {
          "type":"string",
          "const": "Grant"
        },
        "funders": {
          "description": "Legal bodies funding the grant.",
          "type":"array",
          "minItems":1,
          "items": {
            "type":"string",
            "description": "ID of the funding person or organization."
          }
        },
        "number": {
          "type": "string",
          "description": "The number or identifier assigned to the grant by the funding body."
        },
        "name": {
          "type": "string",
          "description": "The name that the type of grant is usually referred to."
        },
        "url": {
          "$ref": "#/definitions/url",
          "description": "The URL of the grant."
        }
      },
      "required": [
        "@id",
        "@type",
        "funders"
      ],
      "additionalProperties": false
    },
    "person": {
      "$comment": "TODO!"
    },
    "dataset": {
      "$comment": "TODO!"
    },
    "organization": {
      "description": "An organization.",
      "type":"object",
      "properties": {
        "@id": {
          "type": "string",
          "description": "ID of the organization."
        },
        "@type": {
          "type":"string",
          "const": "Organization"
        },
        "names": {
          "type": "array",
          "description": "Names of the organization."
        },
        "url": {
          "$ref": "#/definitions/url",
          "description": "The URL of the organization's website."
        },
        "email": {
          "$comment": "TODO!"
        },
        "address": {
          "$comment": "TODO!"
        }
      },
      "required": [
        "@id",
        "@type",
        "names"
      ],
      "additionalProperties": false
    }
  }
}
